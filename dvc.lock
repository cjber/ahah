schema: '2.0'
stages:
  get_osm_data:
    cmd: python -m ahah.get_osm_data
    deps:
    - path: data/raw/osm_pbf
      md5: c5116bc0106eda7606024dcfa36e1a6f.dir
      size: 2712241487
      nfiles: 50
    outs:
    - path: data/processed/osm/edges.csv
      md5: 09702d142f986b176feac9e38bc3f2f6
      size: 555343026
    - path: data/processed/osm/nodes.csv
      md5: e8a1ad6d7ba38e3a13477941d8e08735
      size: 911873003
  process_data:
    cmd: python -m ahah.process_data
    deps:
    - path: data/processed/osm/nodes.parquet
      md5: 059212d4a1797e1324c53673ff148095
      size: 147137253
    - path: data/raw/epharmacyhq.zip
      md5: 5dfc86877a3bc1af995e8144aee25985
      size: 441965
    - path: data/raw/postcodes
      md5: c6631913c4f418f5089deab8355c4de3.dir
      size: 158967961
      nfiles: 120
    - path: data/raw/scot/Practice_ContactDetails_Jan2021_v2.xlsx
      md5: 6ef6ebcb11d412c2bfb91275ee826e35
      size: 117669
    outs:
    - path: data/processed/gp.parquet
      md5: b672d50504ecbb9931e028d58b9885d3
      size: 37517644
    - path: data/processed/postcodes.parquet
      md5: e8b0f6959744eb1f640e94a003d93252
      size: 32303831
  routing:
    cmd: python -m ahah.routing
    deps:
    - path: data/processed/gp.parquet
      md5: b672d50504ecbb9931e028d58b9885d3
      size: 37517644
    - path: data/processed/osm/edges.parquet
      md5: d8ab73f711e315687aa6291ec4c5c6ca
      size: 683729391
    - path: data/processed/postcodes.parquet
      md5: e8b0f6959744eb1f640e94a003d93252
      size: 32303831
    outs:
    - path: data/out/gp_dist.csv
      md5: 68858b3700485e9cb791d09af1f76bc5
      size: 86961512
  filter_osm:
    cmd: python -m ahah.filter_osm
    deps:
    - path: data/raw/osm_pbf
      md5: 4d707fd97877b2018d3cd6d2569be1c5.dir
      size: 3029370641
      nfiles: 4
    outs:
    - path: data/processed/osm/edges.csv
      md5: b54996edc26c13b6a5c7dc2342813c2a
      size: 247473486
    - path: data/processed/osm/nodes.csv
      md5: 3c5e5e7ba2da045fe7a0f5bf40892923
      size: 251466086
  osm_graph:
    cmd: python -m ahah.osm_graph
    deps:
    - path: data/raw/osm_pbf
      md5: 53431f6b3ac1a576bedde07b7e1fd174.dir
      size: 3038968842
      nfiles: 3
    outs:
    - path: data/processed/osm/edges.parquet
      md5: d8ab73f711e315687aa6291ec4c5c6ca
      size: 683729391
    - path: data/processed/osm/nodes.parquet
      md5: 059212d4a1797e1324c53673ff148095
      size: 147137253
